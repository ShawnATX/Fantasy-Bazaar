(this["webpackJsonpfantasy-bazaar"]=this["webpackJsonpfantasy-bazaar"]||[]).push([[0],{42:function(e,a,t){e.exports=t.p+"static/media/female-assassin.bea0dac7.png"},43:function(e,a,t){e.exports=t.p+"static/media/female-dress.80670c2c.png"},44:function(e,a,t){e.exports=t.p+"static/media/male-archer.1aedf0f5.png"},45:function(e,a,t){e.exports=t.p+"static/media/male-elf-green.441ef791.png"},46:function(e,a,t){e.exports=t.p+"static/media/male-fighter.9a29969a.png"},47:function(e,a,t){e.exports=t.p+"static/media/male-rogue.ecc3ef84.png"},48:function(e,a,t){e.exports=t.p+"static/media/orc-barbarian.e0001940.png"},49:function(e,a,t){e.exports=t.p+"static/media/female-blue.f7c81c7c.png"},50:function(e,a,t){e.exports=t.p+"static/media/bazaar.1fb66236.jpg"},51:function(e,a,t){e.exports=t(86)},62:function(e,a,t){},63:function(e,a,t){},86:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),c=t(38),l=t.n(c),s=t(11),o=t(39),m=(t(62),t(17)),i=t(4),u=(t(63),t(10)),d=t(20),p=t(89),h=t(90),b=t(91);var E=e=>r.a.createElement(p.a,{fluid:!0,className:"text-center"},r.a.createElement(h.a,{className:"mt-5 px-5"},r.a.createElement(b.a,null,r.a.createElement(u.b,{to:"/newusertype",alt:"Get Started",className:"text-center"},r.a.createElement("button",{className:"splashBtn"},"Get Started")))),r.a.createElement(h.a,{className:"mt-5 px-5"},r.a.createElement(b.a,null,r.a.createElement(u.b,{to:"/login"},r.a.createElement("button",null,"Login Here")))));var g=r.a.createContext({isAuthenticated:!1,user:{},userHasAuthenticated:()=>{}}),f=t(95),N=t(92),w=t(93),y=t(94),v=t(5),x=t.n(v),C=function(e){return x.a.get("/api/items/"+e)},j=function(e){return console.log(e),x.a.post("/api/items/many",{items:e})},O=function(e){return x.a.post("/api/users",e)},S=function(e){return x.a.put("/api/users/purchase",e)},z=function(e){return x.a.put("/api/users/sell",e)},k=function(e){return x.a.post("/api/users/login",e)},I=function(){return x.a.get("/logout")},A=function(e){return x.a.get("/api/bazaars/code/"+e)},P=function(e){return x.a.get("/api/bazaars/"+e)},B=t(42),H=t.n(B),M=t(43),W=t.n(M),D=t(44),R=t.n(D),G=t(45),q=t.n(G),L=t(46),_=t.n(L),T=t(47),U=t.n(T),J=t(48),V=t.n(J),F=t(49),X=t.n(F);const $=[H.a,W.a,R.a,q.a,_.a,U.a,V.a,X.a];var K=e=>r.a.createElement(N.a,{tag:"fieldset",onChange:e.handleInputChange},r.a.createElement("legend",null,"Select a character image"),r.a.createElement("div",{className:"row"},$.map(e=>r.a.createElement("div",{className:"col-sm-3 p-4",key:e},r.a.createElement(N.a,{check:!0},r.a.createElement(w.a,{check:!0},r.a.createElement(y.a,{type:"radio",name:"characterImage",value:e}),r.a.createElement("img",{src:e,className:"img-fluid",alt:e})))))));var Q=function(){const e=Object(n.useContext)(g).authenticationState,a=Object(n.useState)({}),t=Object(i.a)(a,2),c=t[0],l=t[1],o=Object(d.f)(),u=Object(s.c)();function h(e){const a=e.target,t=a.name,n=a.value;l(Object(m.a)({},c,{[t]:n}))}return r.a.createElement(p.a,null,r.a.createElement(f.a,{onSubmit:function(a){a.preventDefault(),c.characterName&&c.playerName&&c.password&&c.bazaarId&&c.characterImage&&A(c.bazaarId).then(a=>{const t=a.data._id,n={userName:c.playerName,characterName:c.characterName,type:"Player",wallet:c.wallet,password:c.password,characterImage:c.characterImage,items:[],bazaars:[t]};O(n).then(a=>{200===a.status?k({userName:n.userName,password:n.password}).then(a=>{e.userHasAuthenticated(!0,{userName:a.data.userName,characterName:a.data.characterName,characterImage:a.data.characterImage,type:a.data.type,wallet:a.data.wallet,items:a.data.items,bazaars:a.data.bazaars})}).then(o.push("/playerhome")).catch(e=>{u.show("Login problem :("),console.log(e)}):o.push("/login")}).catch(e=>{u.show("Unable to create a user with the provided username, please try a different one."),console.log(e)})}).catch(e=>{u.show("Bazaar with the provided Join Code not found."),console.log(e)})},className:"text-center"},r.a.createElement(N.a,{row:!0,className:"mt-4"},r.a.createElement(w.a,{className:"text-center",for:"characterName"},"Character Name"),r.a.createElement(y.a,{name:"characterName",id:"characterName",placeholder:"Lester Ressoration",onChange:h})),r.a.createElement(N.a,{row:!0},r.a.createElement(w.a,{for:"characterName"},"Fantasy Bazaar Username"),r.a.createElement(y.a,{name:"playerName",id:"playerName",placeholder:"Username",onChange:h})),r.a.createElement(N.a,{row:!0},r.a.createElement(w.a,{for:"password"},"Password"),r.a.createElement(y.a,{type:"password",name:"password",id:"password",placeholder:"Password",onChange:h})),r.a.createElement(K,{handleInputChange:h}),r.a.createElement(N.a,null,r.a.createElement(w.a,{for:"startingGold"},"Starting Wealth"),r.a.createElement(y.a,{name:"wallet",id:"startingGold",placeholder:"Enter your starting gold",onChange:h})),r.a.createElement(N.a,null,r.a.createElement(w.a,{for:"bazaarId"},"Bazaar Code"),r.a.createElement(y.a,{name:"bazaarId",id:"bazaarId",placeholder:"Bazaar Code Here",onChange:h})),r.a.createElement("button",{className:"btn-small mr-3"},"Submit"),r.a.createElement("button",{className:"btn-small ml-3",onClick:function(e){e.preventDefault(),o.push("/")}},"Back Home")))};var Y=()=>r.a.createElement("div",null,"Sorry, page not found! :(");var Z=e=>{const a=Object(n.useContext)(g).authenticationState;return r.a.createElement(h.a,{className:"border align-middle"},r.a.createElement(b.a,{className:"align-middle"},r.a.createElement("h4",null,e.item.name)," ",e.quantity?"X".concat(e.quantity):""),r.a.createElement(b.a,null,r.a.createElement("h5",null,e.item.value)," Gold"),r.a.createElement(b.a,null,r.a.createElement("h5",null,e.item.weight)," lbs."),r.a.createElement(b.a,null,(()=>{switch(e.item.type){case"Weapon":return e.item.description.properties?"Damage: ".concat(e.item.description.damage,"\n                    Properties: ").concat(e.item.description.properties):"Damage: ".concat(e.item.description.damage);case"Armor":return e.item.description.skillModifier&&e.item.description.abilityReq?"Armor Class: ".concat(e.item.description.ac,"\n                            \n                    Skill Modifier: ").concat(e.item.description.skillModifier,"\n                            \n                    Ability Requirements: ").concat(e.item.description.abilityReq):e.item.description.skillModifier?"Armor Class: ".concat(e.item.description.ac,"\n                            Skill Modifier: ").concat(e.item.description.skillModifier):e.item.description.skillModifier?"Armor Class: ".concat(e.item.description.ac,"\n                            Ability Requirements: ").concat(e.item.description.abilityReq):"Armor Class: ".concat(e.item.description.ac);case"Consumable":return"".concat(e.item.description.description)}})()),r.a.createElement(b.a,null,r.a.createElement("button",{className:"btn-small my-1 float-right",onClick:()=>e.action(e.item),disabled:e.item.value>a.user.wallet&&"Purchase"===e.button},e.button)))};var ee=e=>{const a=Object(n.useState)([]),t=Object(i.a)(a,2),c=t[0],l=t[1],s=Object(n.useContext)(g).authenticationState;Object(n.useEffect)(()=>{j(e.items).then(e=>{l(e.data)})},[s,e.items]);const o=a=>{let t=0;for(let n=0;n<e.items.length;++n)e.items[n]===a&&t++;return t};return r.a.createElement("div",null,r.a.createElement(h.a,{className:"mt-4 px-5"},r.a.createElement(b.a,{className:"mb-1 text-center"},r.a.createElement("button",{href:"#home",alt:"Back Home",className:"text-center btn-small",onClick:()=>e.setPageState("Home")},"Back Home"))),e.items.length>0?c.map(a=>r.a.createElement(Z,{key:a._id,item:a,quantity:o(a._id),action:e.sell,button:"Sell"})):"No items in inventory at this time. Maybe give the Bazaar a visit?")};var ae=e=>r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header p-2",id:e.type+"head"},r.a.createElement("h2",{className:"mb-0 text-center"},r.a.createElement("button",{className:"btn",type:"button","data-toggle":"collapse","data-target":"#"+e.type+"body","aria-expanded":"true","aria-controls":e.type+"body"},e.type))),r.a.createElement("div",{id:e.type+"body",className:e.expanded,"aria-labelledby":e.type+"head","data-parent":"#itemMenu"},r.a.createElement("div",{className:"card-body"},e.items.map(a=>r.a.createElement(Z,{key:a._id,item:a,action:e.action,button:e.button})))));var te=e=>{const a=Object(n.useState)([]),t=Object(i.a)(a,2),c=t[0],l=t[1];Object(n.useEffect)(()=>{C("DnD").then(e=>{l(e.data)})},[]);let s=[];const o=e=>c.filter(a=>a.type===e);return r.a.createElement("div",null,r.a.createElement(h.a,{className:"mt-5 px-5"},r.a.createElement(b.a,{className:"text-center"},r.a.createElement("button",{href:"",alt:"Back Home",className:"text-center mb-1 btn-small",onClick:()=>e.setPageState("Home")},"Back Home"))),(c.forEach(e=>{}),void(s=Array.from(new Set(c.map(e=>e.type))))),r.a.createElement("div",{className:"accordion",id:"itemMenu"},s.map(a=>r.a.createElement(ae,{key:a,type:a,items:o(a),expanded:"Consumable"===a?"collapse show":"collapse",action:e.purchase,button:"Purchase"}))))};var ne=e=>r.a.createElement("div",null,r.a.createElement(h.a,{className:"mt-5 px-5"},r.a.createElement(b.a,{className:"text-center"},r.a.createElement("button",{href:"#Inventory",alt:"Manage Inventory",className:"text-center",onClick:()=>e.setPageState("Inventory")},"Manage Inventory"))),r.a.createElement(h.a,{className:"my-5 px-5"},r.a.createElement(b.a,{className:"text-center"},r.a.createElement("button",{href:"#Store",alt:"Visit The Bazaar",className:"text-center",onClick:()=>e.setPageState("Store")},"Visit The Bazaar"))));var re=()=>{const e=Object(n.useContext)(g).authenticationState,a=Object(n.useState)({}),t=Object(i.a)(a,2),c=t[0],l=t[1],o=Object(n.useState)("Home"),m=Object(i.a)(o,2),u=m[0],E=m[1],f=Object(d.f)(),N=Object(s.c)();function w(a){console.log(a._id,c);let t=e.user.items,n=e.user.wallet;for(var r=0;r<e.user.items.length;r++)e.user.items[r]===a._id&&(t.splice(r,1),n+=a.value,r=e.user.items.length);console.log(t),z({items:t,wallet:n}).then(a=>{l({userName:a.data.userName,characterName:a.data.characterName,characterImage:a.data.characterImage,type:a.data.type,wallet:a.data.wallet,items:a.data.items,bazaars:a.data.bazaars}),e.userHasAuthenticated(!0,{userName:a.data.userName,characterName:a.data.characterName,characterImage:a.data.characterImage,type:a.data.type,wallet:a.data.wallet,items:a.data.items,bazaars:a.data.bazaars})})}function y(a){a.value>c.wallet?N.show("Looks like that is a bit too expensive..."):S({wallet:c.wallet-a.value,items:[a._id]}).then(a=>{l({userName:a.data.userName,characterName:a.data.characterName,characterImage:a.data.characterImage,type:a.data.type,wallet:a.data.wallet,items:a.data.items,bazaars:a.data.bazaars}),e.userHasAuthenticated(!0,{userName:a.data.userName,characterName:a.data.characterName,characterImage:a.data.characterImage,type:a.data.type,wallet:a.data.wallet,items:a.data.items,bazaars:a.data.bazaars})}).catch(e=>console.log(e))}Object(n.useEffect)(()=>{e.isAuthenticated||f.push("/login"),l(e.user)},[e]);return r.a.createElement(p.a,null,r.a.createElement(h.a,{className:"border p-1  mb-3 text-center sticky-top playerHeader"},r.a.createElement(b.a,{className:"border text-center p-0 mx-2 mh-75"},r.a.createElement(h.a,{className:"mx-0"},r.a.createElement(b.a,{sm:"8",md:{size:6,offset:3}},r.a.createElement("img",{src:c.characterImage,alt:"Character Portrait",className:"img-fluid mw-50"}))),c.characterName),r.a.createElement(b.a,{className:"border text-center p-0 mx-2"},r.a.createElement(h.a,{className:"mx-0 mt-2"},r.a.createElement(b.a,{className:"justify-center mt-5"},c.wallet,r.a.createElement("img",{className:"img-fluid w-25 ml-1 mb-1",src:"./gold-coin-icon.png",alt:"gold coins"}))))),"Home"===u?r.a.createElement(ne,{setPageState:E}):"Inventory"===u?r.a.createElement(ee,{setPageState:E,items:c.items,sell:w}):"Store"===u?r.a.createElement(te,{setPageState:E,purchase:y}):r.a.createElement(ne,{setPageState:"Home"}),r.a.createElement(h.a,{className:"sticky-footer mt-3"},r.a.createElement(b.a,{className:"text-center"},r.a.createElement("button",{className:"text-center btn-small",onClick:()=>{I().then(a=>{200===a.status?(e.userHasAuthenticated({isAuthenticated:!1,user:{}}),f.push("/")):N.show("Weird logout error happening...")})}},"Logout"))))},ce=t(50),le=t.n(ce);var se=()=>{const e=Object(n.useContext)(g).authenticationState,a=Object(n.useState)({}),t=Object(i.a)(a,2),c=t[0],l=t[1],o=Object(n.useState)({}),m=Object(i.a)(o,2),u=m[0],h=m[1],b=Object(d.f)(),E=Object(s.c)();Object(n.useEffect)(()=>{e.isAuthenticated&&"GM"!==!e.user.type?(E.show("Not currently logged in as a GM"),console.log(e),P(e.user.bazaars[0]).then(e=>{console.log(e),h(e.data)}).catch(e=>{console.log(e)}),l(e.user)):b.push("/login")},[]);return r.a.createElement("div",null,r.a.createElement(p.a,{fluid:!0},r.a.createElement("img",{className:"img-fluid",src:le.a,alt:"Bazaaz"}),c.userName,r.a.createElement("br",null),r.a.createElement("br",null),r.a.createElement("p",{className:"text-center"},"Player Join Code: ",u.joinCode),r.a.createElement("ul",null,r.a.createElement("p",null,"Players:"),console.log(u),u.players?u.players.map(e=>r.a.createElement("li",null,"(player)")):"No Players")),r.a.createElement("button",{onClick:()=>{I().then(a=>{200===a.status?(e.userHasAuthenticated({isAuthenticated:!1,user:{}}),b.push("/")):E.show("Weird logout error happening...")})}},"Logout"))};var oe=function(){const e=Object(n.useState)(""),a=Object(i.a)(e,2),t=a[0],c=a[1];return r.a.createElement(p.a,null,r.a.createElement(h.a,{className:"mt-5 px-5"},r.a.createElement(b.a,null,r.a.createElement(u.b,{to:"/newusercreds/gm",alt:"Create a new Bazaar",className:"text-center"},r.a.createElement("button",{className:"splashBtn"},"Create a new Bazaar")))),r.a.createElement(h.a,{className:"mt-5 px-5"},r.a.createElement(b.a,null,r.a.createElement(u.b,{to:"/newnewusercreds/player?bazaarid="},r.a.createElement("button",null,"Join a bazaar")),r.a.createElement(f.a,{onSubmit:function(e){e.preventDefault()},className:"text-center"},r.a.createElement(N.a,null,r.a.createElement(w.a,{for:"bazaarCode"},"Bazaar Join Code"),r.a.createElement(y.a,{type:"text",name:"bazaarCode",id:"bazaarCode",placeholder:"Bazaar Code Here",onChange:function(e){console.log(e.target);const a=e.target,n=a.name,r=a.value;c({[n]:r}),console.log(r),9===r.length&&A(t.bazaarCode).then(e=>{console.log(e)})}}))))))};var me=function(){Object(n.useContext)(g).authenticationState;const e=Object(n.useState)({}),a=Object(i.a)(e,2),t=a[0],c=a[1],l=Object(d.f)();function o(e){const a=e.target,n=a.name,r=a.value;c(Object(m.a)({},t,{[n]:r}))}return Object(s.c)(),r.a.createElement(p.a,null,r.a.createElement(f.a,{onSubmit:function(e){e.preventDefault(),t.email&&t.password},className:"text-center"},r.a.createElement(N.a,{row:!0,className:"mt-4"},r.a.createElement(w.a,{className:"text-center",for:"email"},"Email Address"),r.a.createElement(y.a,{name:"email",id:"email",placeholder:"myemailaddress@interwebs.com",onChange:o})),r.a.createElement(N.a,{row:!0},r.a.createElement(w.a,{for:"password"},"Password"),r.a.createElement(y.a,{type:"password",name:"password",id:"password",placeholder:"Password",onChange:o})),r.a.createElement("button",{className:"btn-small mr-3"},"Submit"),r.a.createElement("button",{className:"btn-small ml-3",onClick:function(e){e.preventDefault(),l.push("/")}},"Back Home")))};var ie=()=>{const e=Object(n.useContext)(g).authenticationState,a=Object(n.useState)({}),t=Object(i.a)(a,2),c=t[0],l=t[1],o=Object(d.f)(),E=Object(s.c)();function w(e){const a=e.target,t=a.name,n=a.value;l(Object(m.a)({},c,{[t]:n}))}return r.a.createElement(p.a,null,r.a.createElement(f.a,{onSubmit:function(a){if(a.preventDefault(),c.userName&&c.password){const a={userName:c.userName.trim(),password:c.password};k(a).then(a=>{200===a.status&&(console.log(a.data),e.userHasAuthenticated(!0,{userName:a.data.userName,characterName:a.data.characterName,characterImage:a.data.characterImage,type:a.data.type,wallet:a.data.wallet,items:a.data.items,bazaars:a.data.bazaars}),"GM"===a.data.type?o.push("/gmhome"):o.push("/playerhome"))}).catch(e=>{E.show("No user found with those credentials")})}else E.show("Please enter a username and password")},className:"mt-5"},r.a.createElement(N.a,{row:!0,className:"mb-4"},r.a.createElement(y.a,{name:"userName",id:"userName",placeholder:"User Name",onChange:w})),r.a.createElement(N.a,{row:!0,className:"mb-4"},r.a.createElement(y.a,{type:"password",name:"password",id:"password",placeholder:"Password",onChange:w})),r.a.createElement(h.a,null,r.a.createElement(b.a,{className:"text-center mt-3"},r.a.createElement("button",null,"Submit")))),r.a.createElement(b.a,{className:"text-center mt-3"},r.a.createElement(u.b,{to:"/"},r.a.createElement("button",null,"Go Back"))))};var ue=function(){const e=Object(n.useState)({updates:0,isAuthenticated:!1,user:{},userHasAuthenticated:(e,a)=>{c(Object(m.a)({},t,{isAuthenticated:e,user:a,updates:t.updates++}))}}),a=Object(i.a)(e,2),t=a[0],c=a[1];return r.a.createElement(g.Provider,{value:{authenticationState:t}},r.a.createElement(u.a,null,r.a.createElement("div",{className:"app"},r.a.createElement(d.c,null,r.a.createElement(d.a,{exact:!0,path:"/"},r.a.createElement(E,null)),r.a.createElement(d.a,{exact:!0,path:"/playerhome"},r.a.createElement(re,null)),r.a.createElement(d.a,{exact:!0,path:"/gmhome"},r.a.createElement(se,null)),r.a.createElement(d.a,{exact:!0,path:"/newplayer"},r.a.createElement(Q,null)),r.a.createElement(d.a,{exact:!0,path:"/newusertype"},r.a.createElement(oe,null)),r.a.createElement(d.a,{exact:!0,path:"/newusercreds/:type"},r.a.createElement(me,null)),r.a.createElement(d.a,{exact:!0,path:"/newbazaar"}),r.a.createElement(d.a,{exact:!0,path:"/login"},r.a.createElement(ie,null)),r.a.createElement(d.a,{path:"*"},r.a.createElement(Y,null))))))};const de=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function pe(e,a){navigator.serviceWorker.register(e).then(e=>{e.onupdatefound=()=>{const t=e.installing;null!=t&&(t.onstatechange=()=>{"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),a&&a.onUpdate&&a.onUpdate(e)):(console.log("Content is cached for offline use."),a&&a.onSuccess&&a.onSuccess(e)))})}}).catch(e=>{console.error("Error during service worker registration:",e)})}const he={position:s.b.BOTTOM_CENTER,timeout:4e3,offset:"5px",transition:"fade"};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(s.a,Object.assign({template:o.a},he),r.a.createElement(ue,null))),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",()=>{const a="".concat("","/service-worker.js");de?(!function(e,a){fetch(e,{headers:{"Service-Worker":"script"}}).then(t=>{const n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(e=>{e.unregister().then(()=>{window.location.reload()})}):pe(e,a)}).catch(()=>{console.log("No internet connection found. App is running in offline mode.")})}(a,e),navigator.serviceWorker.ready.then(()=>{console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):pe(a,e)})}}()}},[[51,1,2]]]);
//# sourceMappingURL=main.1eeda73a.chunk.js.map